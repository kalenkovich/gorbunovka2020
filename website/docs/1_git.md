# Git

Git - система, которая позволяет хранить историю изменения файлов в вашем проекте.
По большей части вы в ней храните файлы с текстом или код (`.txt`, `.md`, `.py`, `.r`, `.rmd`, `.csv` и т.д.), но ничего, кроме соображений экономии места на диске или в облаке, не мешает вам там же хранить какие-угодно файлы.
Вот несколько основных преимуществ от ее использования:

- вы сильно реже будете оказываться в ситуации "я ничего в коде не менял, а оно почему-то больше не работает", потому что вы всегда можете посмотреть, что вы там на самом деле поменяли,
- у вас будет возможность посмотреть, когда и с какого черта появился любой кусок теста и/или кода,
- вы получаете инструмент, который позволяет вам с коллегами параллельно работать над одним и тем же проектом, а потом контролируемо сводить это все вместе.

Чтобы использовать полностью все возможности git нужно с ним работать, запуская основную программу git, а также разные вспомогательные утилиты в командной строке.
Раньше или позже вы столкнетесь с проблемой, которая вас сподвигнет изучить такой способ использования git, но без него в большинистве случаем можно спокойно обойтись.
Для это мы с вами установили SourceTree, в котором все то же самое можно делать, кликая на кнопочки в графическом интерфейсе.
Заодно мы получаем довольно удобную визуализацию историю развития репозитория, которая помогает в нем ориентироваться.

В этом туториале мы создадим репозиторий и научимся базовым операция по работе с ним.
Этих операций хватает в большинстве случаев.
При большом желании можно никогда про другие и не узнавать.

## Репозиторий

Git-репозиторий - папка, в которой хранятся все файлы вашего проекта в текущем его состоянии, а также скрытая папка ".git", в которой хранятся все вспомогательные файлы, которые позволяют git работать, а вам - перемещаться в произвольное место в истории развития вашего проекта.

Более строго репозиторием называется только то, что хранится в папке ".git", а непосредственно файлы, которые находятся в корневой папке называются **рабочим деревом** (**working tree**).
Это разграничение не только вопрос занудства - нам еще понадобится этот термин.

*Задание*

- Создайте в вашей рабочей папке подпапку "repo" (стандартное сокращение от слова repository - репозиторий)
- Откройте SourceTree
- В меню наверху выберите `File` -> `Clone/New` (также можно нажать `Ctrl+N` на клавиатуре или кнопку с плюсиком в интерфейсе)
- Выберите вкладку "Create"
- Нажмите Browse - выберите там папку "repo"
- Во второй строке поменяйте "repo" на "Репродуцируемый анализ данных" (это влияет только на отображение в SourceTree)
- Поставьте галочку около "Create Repository On Account:"
- Выберите ваш аккаунт на GitHub
- Если хотите, можете что-нибудь вписать в Description
- Нажмите "Create"

<инструкция с картинками>

## Коммиты

В git-терминологии коммитом называется сохраненное состояние всех файлов в репозитории, отслеживаемых git'ом.
Но также коммитом называют процесс сохранения подобного состояния.
Поэтому можно "закоммитить файл" (т.е. добавить файл в репозиторий и создать новый коммит, который будет включать этот файл), а можно "откатиться ко вчерашнему коммиту" (т.е. вернуть все файлы в то состояние, которое было сохранено вчера).

На данный момент наш репозиторий абсолютно пустой.
Сейчас мы это исправим: создадим файл, добавим его в репозиторий и закоммитим.

*Задание*

Создайте пустой текстовый файл "readme.md" в корне репозитория и вставьте в него следующий текст (вместе с решеткой).

```
# Эффект Струпа

В психологии эффектом Струпа (англ. Stroop effect) называют задержку реакции при прочтении слов, когда цвет слов не совпадает с написанными словами (к примеру, слово «красный» написано синим).

*взято с [википедии](https://ru.wikipedia.org/wiki/%D0%AD%D1%84%D1%84%D0%B5%D0%BA%D1%82_%D0%A1%D1%82%D1%80%D1%83%D0%BF%D0%B0)*
```

Посли отрисовки (это произойдет несколькими шагами ниже) ваш текст будет выглядеть примерно так:

> <h1> Эффект Струпа </h1>
> 
> В психологии эффектом Струпа (англ. Stroop effect) называют задержку реакции при прочтении слов, когда цвет слов не совпадает с написанными словами (к примеру, слово «красный» написано синим).
> 
> *взято с [википедии](https://ru.wikipedia.org/wiki/%D0%AD%D1%84%D1%84%D0%B5%D0%BA%D1%82_%D0%A1%D1%82%D1%80%D1%83%D0%BF%D0%B0)*

*Задание*

- В SourceTree выделите файл `readme.md` в области "Unstaged Files" и нажмите "Stage Selected", чтобы перенести этот файл в область "Staged Files".
- В нижней части в пустом белом прямоугольнике введите описание нашего будущего коммита: "add readme.md".
- Нажмите "Commit"

<инструкция с картинками>


## Ветки

Ветки - параллельные версии вашего репозитория.
То, что вы делаете в одной ветке, никак не затрагивает другие ветки.
Это позволяет

- поэкспериментировать со скриптом PsychoPy, который уже точно работает, не боясь, что вы все испортите
- работать над предобработкой данных утром и над кодом анализа вечером, не боясь, что поменяете что-то в коде, который задействуется и там, и там
- работать над разными частями проекта параллельно с другими людьми, не боясь, что вы запорете работу друг друга или не сможет потом все аккуратно свести так, чтобы у всех все работало

Важный момент здесь - "не боясь".
Если вы делает что-то из списка выше без версионирования и не живете в постоянном неконтролируемом страхе, что у вас не получится ничего повторить с теми же результатами, что в первый раз - зря.
А с git и ветками можно будет не бояться (ну, или хотя бы меньше бояться).

Традиционно первая и одновременно основная ветка в вашем репозитории называется `master`.
Каждый раз, когда вы начинаете работать над каким-то новым куском проекта, вы создаете новую ветку (скажем, под названием `ek_update-intro`).

> Ветки можно называть как-угодно, но удобно выбрать один какой-то паттерн и придерживаться его внутри репозитория.
> Например, `<ваши инициалы маленькими латинскими буквами>_<краткое описание назначения ветки>`.
> Мой инициалы - `ek`, я хотел внести правки во введение статьи, поэтому назвал ветку `ek_update-intro`.

Дальше вы на нее переходите (*checkout*), после чего все ваши коммиты пойдут уже в эту новую ветку.
Когда вы убедитесь, что все работает и при этом не поломалось ничего, что у вас было сделано до создания этой ветки, вы сливаете (*merge*) вашу ветку с веткой `master`.
Делается это следующим образом: 

- вы переходите (*checkout*) на ветку `master` (в результате все ваши изменения пропадут из вашей рабочей папки, но они все еще хранятся в репозитории)
- вы сливаете вашу новую ветку `ek_update-intro` в ветку `master` (при этом создается специальный коммит слияния - *merge commit*)

Сейчас вы сможете сами провести все эти действия.

*Задание*

- Нажмите на кнопку "Branch" и создайте новую ветку под тем названием, которое захотите. 
- Проверьте, что в левой части окна SourceTree появилась новая ветка, ее название выделено жирным шрифтом, а слева от нее стоит черный кружок - так в SourceTree обозначается ветка, на который вы сейчас находитесь (которая *checked out*).
- Внесите какие-нибудь правки в описание эффекта Струпа в `readme.md` (не забудьте сохранить файл). Например, добавьте следующий абзац:

		Иногда в это понятие также включают ускорение реакции, когда цвет слов совпадает с написанными словами (к примеру, слово «красный» написано красным), по сравнению с теми случаями, когда слово не описывает цвет (к примеру, слово «стул» написано красным).

- В SourceTree:
    - Закоммитьте изменения (не забудьте добавить какое-нибудь описание).
    - Нажмите на название своей ветки в левой панели - отобразится дерево вашего репозитория. Обратите внимание, что ветка `master` осталась позади нашей новой ветки.
	- Перейдите на ветку `master`: кликните по ней правой кнопкой и нажмите `Checkout master...`. Убедитесь, что `master` выделено жирным шрифтом, а слева от него стоит черный кружок.
	- Теперь кликните правой кнопкой по своей ветке и нажмите `Merge <название-вашей-ветки> into current branch`.
	- В появившемся окошке поставьте галочку около `Create a new commit even if fast-forward is possible` и нажмите `OK`.
	- Посмотрите на визуализацию дерева вашего репозитория (если она закрылась, нажмите левой кнопкой на `master`). Вы увидите, что мы сделали:
		- Ответвились (*branched out*) от `master`.
		- Создали коммит.
		- Вветвились обратно в (*merged into*) `master`.


## GitHub

GitHub - онлайн-хранилище репозиториев.
Хранить копию репозитория онлайн - очень удобный способ обмениваться текущей версией вашего проекта с коллегами.
Каждый, кто что-то добавил, загружает (*push*) обновленные ветки на GitHub.
После этого все остальные могут скачать (*pull*) любую ветку на локальный компьютер.
Таким образом, вы добиваетесь синхронизации вашего проекта между всеми участниками.

- Убедитесь, что вы находитесь на ветке `master`.
- Нажмите кнопку `Push` вверху SourceTree.
- В появившемся окошке убедитесь, что галочка стоит только возле ветки `master`.
- Нажмите кнопку `Push` (внутри окошка).
- Дождитесь, пока SourceTree закончит делать, что делал.

Теперь ваша ветка `master`, а вместе с ней все коммиты, которые к ней ведут, оказались на GitHub.
Давайте проверим, что это действительно произошло.

*Задание*

- Нажмите на кнопку `Remote` в правом верхнем углу - вас перекинет в браузер, в котором откроется страничка вашего репозитория на GitHub.
- Убедитесь, что на вкладке `<> Code` вы видите единственный файл `readme.md`. 
  Можете открыть его, чтобы убедиться, что внутри него тот же текст, что и на вашем компьютере.
- Когда GitHub находит в корне репозитория файл под названием `readme.md`, то он попробует его отрисовать, используя свою версию markdown - вы можете увидеть результат чуть ниже.
