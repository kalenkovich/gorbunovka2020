# renv

R-пакет renv - система управления пакетами R.
То, что мы делали для питона, его пакетов, R и потенциально другого софта с помощью conda, для R мы будем делать с помощью renv.
renv выполняет гораздо более ограниченную функцию, чем conda - он только следит за пакетами R.
Зато работа с ним гораздо проще для пользователя:

- один единственный файл `renv.lock` вместо `environment.yml` и `environment-full.yml`,
- `renv.lock` пополняется программно - не нужно ничего править руками,
- удаление пакета или откат к предыдущему состоянию не принуждает нас восстанавливать весь энвайронмент с нуля,
- если мы запускаем R/RStudio из корня репозитория, то renv не нужно отдельно активировать,
- точно еще что-то, чего я пока не вспомнил.

renv при инициализации создает следующие файлы/папки:

- `.Rprofile` - скрипт, который активирует renv, когда р запускается из корня репозитория.
- `renv.lock` - файл со списком пакетов, их версий и того, откуда они были взяты.
- `renv/activate.R` - скрипт-помощник, который активирует renv; именно его вызывает `.Rprofile`.
- `renv/library` - тут хранятся все пакеты вашего проекта.

При работе с renv по большей части достаточно будет выучить три команды:

- `renv::init(bare = TRUE)` - инициализация renv в текущей папке (как раз создадутся все файлы/папки, которые мы обсуждали выше).

	> Я советую запускать `init` именно с параметром `bare=TRUE`, который говорит что не надо пока в библиотеку `renv/library` ничего устанавливать.
	> В противном случае renv попытается сохранить в проект все библиотеки, которые у нас уже установлены (в библиотеке R нашего condsa-энвайронмента), а также пройтись по всем R-файлам (`.r`, `.rmd`), которые у нас есть в репозитории, и выцепить оттуда все пакеты R, которые вы в них загржаете.
	> Гораздо лучше брать этот процесс в свои руки: установили пакет, отметили его в renv (см. ниже), закоммитили.

- `renv::snapshot()` - сохранить текущее состояние библиотеки в `renv.lock`
- `renv::restore()` - восстановить состояние библиотеки до состояния, сохраненного в `renv.lock`.

Подробнее можно прочитать про renv на его [страничке](https://rstudio.github.io/renv/index.html) или в виньетке ["Introduction to renv"](https://rstudio.github.io/renv/articles/renv.html).
